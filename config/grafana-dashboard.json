{
  "dashboard": {
    "id": null,
    "uid": "decision-orchestrator-uid",
    "title": "Decision Orchestrator Overview",
    "timezone": "browser",
    "schemaVersion": 27,
    "version": 1,
    "refresh": "15s",
    "panels": [
      {
        "type": "graph",
        "title": "Decisions Processed (rate)",
        "gridPos": { "x": 0, "y": 0, "w": 12, "h": 6 },
        "id": 1,
        "targets": [
          { "expr": "sum(rate(decisions_processed_total[5m]))", "legendFormat": "total", "refId": "A" },
          { "expr": "sum by (result) (rate(decisions_processed_total[5m]))", "legendFormat": "{{result}}", "refId": "B" }
        ],
        "lines": true,
        "linewidth": 2,
        "stack": false
      },
      {
        "type": "graph",
        "title": "Notifier Requests (rate) by channel & status",
        "gridPos": { "x": 12, "y": 0, "w": 12, "h": 6 },
        "id": 2,
        "targets": [
          { "expr": "sum by (channel, status) (rate(notifier_requests_total[5m]))", "legendFormat": "{{channel}} {{status}}", "refId": "A" }
        ],
        "lines": true,
        "linewidth": 2
      },
      {
        "type": "stat",
        "title": "Deduplicated Decisions (rate, 5m)",
        "gridPos": { "x": 0, "y": 6, "w": 6, "h": 4 },
        "id": 3,
        "targets": [
          { "expr": "rate(deduplicated_decisions_total[5m])", "legendFormat": "dedup_rate", "refId": "A" }
        ],
        "format": "short",
        "valueName": "current"
      },
      {
        "type": "table",
        "title": "Circuit Breaker Open (per channel)",
        "gridPos": { "x": 6, "y": 6, "w": 12, "h": 4 },
        "id": 4,
        "targets": [
          { "expr": "max_over_time(circuit_breaker_open[5m])", "refId": "A" },
          { "expr": "sum(circuit_breaker_open) by (channel)", "refId": "B" }
        ],
        "transform": "timeseries_aggregations"
      },
      {
        "type": "graph",
        "title": "Notifier Latency - avg and p95 (per channel)",
        "gridPos": { "x": 0, "y": 10, "w": 24, "h": 8 },
        "id": 5,
        "targets": [
          { "expr": "sum by (channel) (rate(notifier_latency_seconds_sum[5m])) / sum by (channel) (rate(notifier_latency_seconds_count[5m]))", "legendFormat": "{{channel}} avg", "refId": "A" },
          { "expr": "histogram_quantile(0.95, sum by (le, channel) (rate(notifier_latency_seconds_bucket[5m])))", "legendFormat": "{{channel}} p95", "refId": "B" }
        ],
        "lines": true,
        "linewidth": 2
      }
    ],
    "templating": { "list": [] },
    "annotations": { "list": [] }
  },
  "overwrite": true
}
