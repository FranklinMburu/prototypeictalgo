version: 1

modes:
  default: "LIVE"  # LIVE | PAPER | SHADOW
  allow_reasoning: false
  require_human_approval: false

sessions:
  timezone: "Africa/Nairobi"
  killzones:
    london:
      enabled: true
      start: "10:00"     # local time
      end: "13:00"
    newyork:
      enabled: true
      start: "15:30"
      end: "18:00"
  quiet_hours:
    enabled: true
    windows:
      - start: "23:00"
        end: "06:00"

risk:
  max_trades_per_day: 10
  max_trades_per_symbol_per_day: 3
  max_daily_loss_usd: 100.0
  max_drawdown_usd: 300.0
  max_loss_streak: 3
  cooldown_minutes_after_loss: 20
  max_slippage_pct: 0.15   # e.g. 0.15% allowed before veto/defer
  min_rr: 1.5

quality:
  min_confidence: 75
  min_confluence_score: 70
  allowed_models:
    - "SWEEP_CHOCH_POI"
    - "SWEEP_BOS_FVG"
    - "RANGE_LIQUIDITY_RUN_REVERSAL"

regime:
  enabled: true
  allowed:
    - "TREND"
    - "RANGE"
  disallow_when:
    high_volatility: true
    news_risk: false  # you can wire to a calendar later

##
# Outcome Veto Configuration
#
# These settings control the outcome-aware policy gate. When enabled
# the orchestrator will consult historical performance metrics and
# veto trades whose expectancy or win rate fall below the thresholds.
# The minimum sample size prevents spurious decisions on small data sets.
outcome_veto:
  min_sample_size: 20
  expectancy_threshold: -0.05
  win_rate_threshold: 0.45


##
# Memory Veto/Promote Configuration
# Controls the memory-based policy gate. Negative expectancy below this
# threshold triggers a veto; positive expectancy above the positive
# threshold can trigger a promote.
memory_veto:
  memory_top_n: 10
  negative_threshold: -0.05
  positive_threshold: 0.10

outcome_adaptation:
  enabled: false
  window_last_n_trades: 50
  min_sample_size: 20
  suppress_if:
    expectancy_r: -0.05
    win_rate: 0.45
  promote_if:
    expectancy_r: 0.10
    win_rate: 0.55
  per_symbol: true
  per_session: true
  per_model: true

kill_switch:
  auto_activate_on:
    reconciliation_mismatch: true
    broker_disconnect: true
    drawdown_breach: true
    daily_loss_breach: true
##
# Paper Execution Adapter Configuration
#
# Simulates broker execution for paper trading without live broker.
# Feature-flagged OFF by default. When enabled, produces trade outcomes
# for performance attribution and memory recall veto validation.
paper_execution_adapter:
  enabled: false  # Set to true to enable paper trading simulation
  
  # Slippage model: "zero", "fixed_percent", "random_bounded"
  slippage_model: "fixed_percent"
  slippage_fixed_pct: 0.05        # 0.05% = 0.0005 multiplier (fixed model)
  slippage_random_min_pct: 0.0    # Min % slippage (random model)
  slippage_random_max_pct: 0.1    # Max % slippage (random model)
  
  # TP/SL hit model: "instant", "random_bars", "random_hours"
  tpsl_model: "random_bars"
  tpsl_random_bars_min: 5         # Min candles until TP/SL hit
  tpsl_random_bars_max: 100       # Max candles until TP/SL hit
  tpsl_random_hours_min: 1        # Min hours until hit (random_hours model)
  tpsl_random_hours_max: 24       # Max hours until hit (random_hours model)
  
  # Fill assumptions
  assume_fill_on_signal: true     # Fill immediately or with delay
  fill_delay_seconds: 2           # Delay before fill (if not immediate)
  
  # Random seed for determinism (null = no seed, random behavior)
  seed: null
  
  # Win rate for TP/SL hit distribution (70% chance of TP, 30% chance of SL)
  tp_hit_probability: 0.70        # Probability of hitting TP (vs SL)